<!DOCTYPE html>
<html>

<head>
  <!--
    If you are serving your web app in a path other than the root, change the
    href value below to reflect the base path you are serving from.

    The path provided below has to start and end with a slash "/" in order for
    it to work correctly.

    For more details:
    * https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base

    This is a placeholder for base href that will be replaced by the value of
    the `--base-href` argument provided to `flutter build`.
  -->
  <base href="$FLUTTER_BASE_HREF">

  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="description" content="Aplicação para fazer suas provas">

  <!-- iOS meta tags & icons -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="SERAp Estudantes">
  <link rel="apple-touch-icon" href="icons/Icon-192.png">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon.png" />

  <!-- Other icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
  <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
  <link rel="shortcut icon" href="icons/favicon.ico">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="msapplication-config" content="icons/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">


  <title>SERAp Estudantes</title>
  <link rel="manifest" href="manifest.json">

  <script>
    // The value below is injected by flutter build, do not touch.
    var serviceWorkerVersion = null;
  </script>
  <!-- This script adds the flutter initialization JS code -->
  <script src="flutter.js" defer></script>

  <link rel="stylesheet" type="text/css" href="splash/style.css">
  <script src="sql-wasm.js"></script>


  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-messaging.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-analytics.js"></script>
</head>

<body
  style="position: fixed; inset: 0px; overflow: hidden; padding: 0px; margin: 0px; user-select: none; touch-action: none; font: 14px sans-serif; color: red;">

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-85250794-18"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-85250794-18');
  </script>

  <script>
    var firebaseConfig = {
      apiKey: "AIzaSyCtMmNGb4HdXkFzRZTFXmW5Npwk4j1p-mc",
      authDomain: "prod-appserap.firebaseapp.com",
      projectId: "prod-appserap",
      storageBucket: "prod-appserap.appspot.com",
      messagingSenderId: "948771905844",
      appId: "1:948771905844:web:084326ba6e6a46a4788561",
      measurementId: "G-S3WSMCJ3ZD"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();
  </script>

  <script>
    function launchFlutter() {
      // Download main.dart.js
      _flutter.loader.loadEntrypoint({
        serviceWorker: {
          serviceWorkerVersion: serviceWorkerVersion,
        },
        onEntrypointLoaded: function (engineInitializer) {
          engineInitializer.initializeEngine().then(function (appRunner) {
            appRunner.runApp();
          });
        }
      });
    }

    window.addEventListener('load', function (ev) {
      if ('serviceWorker' in navigator) {

        // getting rid of undesired to fetch remote version.json file updated
        var seconds = new Date().getTime();
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.open("GET", '/version.json?v=' + seconds, true);
        xmlhttp.addEventListener('load', function () {
          if (xmlhttp.status == 200) {
            var buildNumber = Array.from(xmlhttp.responseText.matchAll(/"version":"((\\"|[^"])*)"/g), m => m[1]);
            console.log('remote version is ' + buildNumber);
            var currentBuildNumber = window.localStorage.getItem('buildNumber');

            console.log('local version is ' + currentBuildNumber);
            // clear worker cache if remote and local version are different
            if (currentBuildNumber != buildNumber) {
              console.log('App update is necessary. Clearing service workers cache');
              caches.delete('flutter-app-manifest');
              caches.delete('flutter-temp-cache');
              caches.delete('flutter-app-cache');

              // store new version number
              window.localStorage.setItem('buildNumber', buildNumber);
            } else {
              console.log('App is up to date');
            }
          }
          launchFlutter();
        });

        xmlhttp.addEventListener('error', function () {
          launchFlutter();
        });

        xmlhttp.addEventListener('abort', function () {
          launchFlutter();
        });

        xmlhttp.addEventListener('timeout', function () {
          launchFlutter();
        });

        xmlhttp.send();
      } else {
        console.log('Service worker not found. Continue app loading.');
        launchFlutter();
      }
    });
  </script>

  <picture id="splash">
    <source
      srcset="splash/img/light-1x.png 1x, splash/img/light-2x.png 2x, splash/img/light-3x.png 3x, splash/img/light-4x.png 4x"
      media="(prefers-color-scheme: light) or (prefers-color-scheme: no-preference)">
    <source
      srcset="splash/img/dark-1x.png 1x, splash/img/dark-2x.png 2x, splash/img/dark-3x.png 3x, splash/img/dark-4x.png 4x"
      media="(prefers-color-scheme: dark)">
    <img class="center" src="splash/img/light-1x.png" />
  </picture>
</body>

</html>